{% extends 'auth/base.html' %}

{% block content %}
<div class="form-box">
  <div class="login-container">
    <header>Create New Password</header>

    {% if error %}
      <div class="input-box"><div class="alert alert-danger">{{ error }}</div></div>
    {% endif %}
    {% if success %}
      <div class="input-box"><div class="alert alert-success">{{ success }} Redirecting to login...</div></div>
    {% endif %}

    <form id="newPasswordForm" class="two-forms" method="POST">
      <!-- New Password -->
      <div class="input-box password-container">
        <input type="password" name="password" id="newPassword" class="input-field" placeholder="New Password" required>
        <i class='bx bx-lock-alt'></i>
        <span onclick="togglePassword('newPassword','eye1')" style="cursor:pointer;">
          <i id="eye1" class="fa fa-eye"></i>
        </span>
      </div>

      <!-- Confirm Password -->
      <div class="input-box password-container">
        <input type="password" name="confirm_password" id="confirmPassword" class="input-field" placeholder="Confirm Password" required>
        <i class='bx bx-lock-alt'></i>
        <span onclick="togglePassword('confirmPassword','eye2')" style="cursor:pointer;">
          <i id="eye2" class="fa fa-eye"></i>
        </span>
      </div>

      <!-- Submit -->
      <div class="input-box">
        <input type="submit" class="submit" value="Update Password">
      </div>

      <div class="two-col">
        <div class="two">
          <label><a href="{{ url_for('auth.login') }}">Back to Login</a></label>
        </div>
      </div>
    </form>
  </div>
</div>

<script>
function togglePassword(inputId, eyeId){
  const input = document.getElementById(inputId);
  const icon = document.getElementById(eyeId);
  if(input.type==="password"){
    input.type="text";
    icon.classList.remove("fa-eye");
    icon.classList.add("fa-eye-slash");
  } else {
    input.type="password";
    icon.classList.remove("fa-eye-slash");
    icon.classList.add("fa-eye");
  }
}

// Auto redirect after success
{% if success %}
setTimeout(() => {
  window.location.href = "{{ url_for('auth.login') }}";
}, 5000);
{% endif %}
</script>
{% endblock content %}
