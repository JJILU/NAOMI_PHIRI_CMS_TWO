<!DOCTYPE html>
<html dir="ltr" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Tell the browser to be responsive to screen width -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords"
        content="wrappixel, admin dashboard, html css dashboard, web dashboard, bootstrap 5 admin, bootstrap 5, css3 dashboard, bootstrap 5 dashboard, Monsterlite admin bootstrap 5 dashboard, frontend, responsive bootstrap 5 admin template, Monster admin lite design, Monster admin lite dashboard bootstrap 5 dashboard template">
    <meta name="description"
        content="Monster Lite is powerful and clean admin dashboard template, inpired from Bootstrap Framework">
    <meta name="robots" content="noindex,nofollow">
    <title>Classroom Management System</title>
    <link rel="canonical" href="https://www.wrappixel.com/templates/monster-admin-lite/" />
    <!-- Custom CSS -->
    <link href="{{ url_for('static', filename="assets/plugins/chartist/dist/chartist.min.css") }}" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="{{ url_for('static', filename='css/style.min.css') }}" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/dash.css') }}" rel="stylesheet">
     <!-- Favicon icon -->
     <link rel="icon" href="{{ url_for('static', filename='assets/favicon/learning.png') }}" type="image/png">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<style>
    /* ---------- Layout helpers ---------- */
    :root {
      --brand: #4684ba;
      --brand-soft: #72bde8;
      --chat-bg: #ffffff;
      --chat-primary: var(--brand);
      --chat-text: #222;
      --border-radius: 0.5rem;
      --elev: 0 8px 24px rgba(0, 0, 0, 0.12);
    }
    /* Make all cards equal height */
  .card {
      height: 100%;
      display: flex;
      flex-direction: column;
  }
  
  /* Make the image fixed height and crop excess */
  .card-img-top {
      height: 180px;
      width: 100%;
      object-fit: cover;
  }
  
  /* Prevent overflow in the card-body */
  .card-body {
      flex: 1;
      display: flex;
      flex-direction: column;
  }
  
  /* Ellipsis for overflow text */
  .card-body h3,
  .card-body ul li {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
  }
  
  
  /* Fix dropdown clipping if not already fixed */
  .navbar-collapse {
      overflow: visible !important;
  }
  
  
  /* Force Bootstrap dropdown to show even with Monster theme overrides */
  .dropdown-menu {
      display: none !important;
      opacity: 0;
      visibility: hidden;
      transition: 0.2s ease-in-out;
      z-index: 99999 !important;
  }
  
  .dropdown-menu.show {
      display: block !important;
      opacity: 1;
      visibility: visible;
  }
  
  /* Fix Monster Admin cutting off dropdowns */
  .topbar .navbar-collapse {
      overflow: visible !important;
  }
  
  .navbar-collapse {
      overflow: visible !important;
  }
  .dropdown-menu {
      z-index: 99999 !important;
  }

  /* Dropdown items text color */
.navbar .dropdown-menu .dropdown-item {
    color: #fff !important;
}

/* Dropdown items hover effect */
.navbar .dropdown-menu .dropdown-item:hover {
    background-color: rgba(255, 255, 255, 0.15);
    color: #fff !important;
}
  
  /* Fixed Navbar Profile Pic */
  .navbar .dropdown-toggle img.profile-pic {
      width: 48px !important;        /* fixed width */
      height: 48px !important;       /* fixed height */
      border-radius: 50% !important;/* perfect circle */
      object-fit: cover !important;  /* fill circle, crop excess */
      flex-shrink: 0 !important;     /* don't let flex resize */
      display: block !important;     /* avoid flex distortion */
      max-width: none !important;    /* override Bootstrap */
      max-height: none !important;   /* override Bootstrap */
  }
  
  .navbar .dropdown-toggle {
      display: flex !important;
      align-items: center !important;
      gap: 10px;
      min-height: 60px;  /* match image height */
  }

  /* bg color & text color the dropdown  */
  /* Dropdown menu with gradient background */
.navbar .dropdown-menu {
    background: linear-gradient(135deg, #72bde8, #4684ba) !important; /* gradient */
    min-width: 220px !important;           /* slightly bigger width */
    border-radius: 0.5rem;                 /* optional: rounded corners */
    padding: 0.5rem 0;                     /* vertical padding */
    box-shadow: 0 0.5rem 1rem rgba(0,0,0,0.15); /* subtle shadow */
}

/* Dropdown items text color */
.navbar .dropdown-menu .dropdown-item {
    color: #fff !important;               /* white text */
    padding: 0.5rem 1.25rem;             /* padding for nicer spacing */
    font-weight: 500;                     /* slightly bolder */
}

/* Hover effect for dropdown items */
.navbar .dropdown-menu .dropdown-item:hover {
    background-color: rgba(255, 255, 255, 0.2) !important; /* semi-transparent highlight */
    color: #fff !important;
}

/* Divider color */
.navbar .dropdown-menu .dropdown-divider {
    border-top: 1px solid rgba(255,255,255,0.3);
    margin: 0.25rem 0;
}

/* FIX: Add spacing between all dashboard rows */
.container-fluid .row {
    margin-bottom: 25px !important;
}


/* ======================= */
/* TOAST NOTIFICATIONS TOP CENTER */
/* ======================= */
#toast {
  position: fixed;
  top: 20px;
  left: 50%;
  transform: translateX(-50%) translateY(-20px);
  min-width: 250px;
  max-width: 350px;
  padding: 16px 24px;
  border-radius: 12px;
  color: #fff;
  font-weight: 500;
  font-size: 16px;
  background: rgba(39, 39, 39, 0.85); /* dark semi-transparent, suits your theme */
  box-shadow: 0 4px 15px rgba(0,0,0,0.3);
  opacity: 0;
  pointer-events: none;
  transition: all 0.4s ease;
  z-index: 9999;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

#toast.show {
  opacity: 1;
  transform: translateX(-50%) translateY(0);
  pointer-events: auto;
}

#toast.success {
  background: rgba(40, 167, 69, 0.9);
}

#toast.error {
  background: rgba(220, 53, 69, 0.9);
}

#toast.info {
  background: rgba(0, 123, 255, 0.9);
}

#toast .close-toast {
  margin-left: 15px;
  cursor: pointer;
  font-weight: bold;
}


 /* ---------- Chat widget ---------- */
 .chat-widget-btn {
      position: fixed;
      right: 22px;
      bottom: 22px;
      width: 64px;
      height: 64px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--brand-soft), var(--brand));
      box-shadow: 0 10px 30px rgba(70,132,186,.22);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 20000;
      border: none;
      transition: transform .15s ease;
    }
    .chat-widget-btn:active { transform: scale(.98); }

    .chat-widget-btn .chat-icon { width: 28px; height: 28px; filter: drop-shadow(0 2px 6px rgba(0,0,0,.12)); }

    /* Chat panel */
    .chat-panel {
      position: fixed;
      right: 22px;
      bottom: 100px;
      width: 360px;
      max-width: calc(100% - 44px);
      height: 520px;
      display: flex;
      flex-direction: column;
      border-radius: 12px;
      background: var(--chat-bg);
      box-shadow: var(--elev);
      overflow: hidden;
      z-index: 20000;
      transform-origin: bottom right;
      transition: transform .18s cubic-bezier(.2,.9,.3,1), opacity .16s ease;
      opacity: 0;
      visibility: hidden;
    }

    .chat-panel.show { opacity: 1; visibility: visible; transform: translateY(0) scale(1); }

    .chat-header {
      background: linear-gradient(90deg, var(--brand), #2f6f99);
      color: #fff;
      padding: 12px 14px;
      display:flex;
      align-items:center;
      gap: 12px;
    }
    .chat-header img { width:40px; height:40px; border-radius:50%; object-fit:cover; }
    .chat-header .title { font-weight:600; }
    .chat-header .subtitle { font-size: .85rem; opacity:.9; }

    .chat-body {
      padding: 12px;
      background: #f8fbff;
      flex: 1;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .chat-msg { max-width: 78%; padding: 10px 12px; border-radius: 12px; font-size: .95rem; line-height:1.3; }
    .chat-msg.bot { background: #fff; align-self: flex-start; box-shadow: 0 4px 16px rgba(0,0,0,0.04); color: var(--chat-text); }
    .chat-msg.user { background: linear-gradient(135deg, var(--brand-soft), var(--brand)); color:#fff; align-self: flex-end; }

    .chat-input-row {
      display:flex;
      gap:8px;
      padding: 10px;
      border-top: 1px solid #eef4fb;
      background: #fff;
    }
    .chat-input-row input[type="text"] {
      flex:1;
      border-radius: 999px;
      border: 1px solid #e6eef7;
      padding: 10px 14px;
      outline: none;
      font-size: .95rem;
    }
    .chat-input-row button {
      background: var(--chat-primary);
      color: #fff;
      border-radius: 999px;
      border: none;
      padding: 8px 12px;
    }

    /* Small screens: use full width bottom */
    @media (max-width: 480px) {
      .chat-panel { right: 12px; left: 12px; bottom: 82px; width: auto; height: 62vh; }
      .chat-widget-btn { right: 12px; bottom: 12px; }
    }


</style>
</head>

<body>
    
    <!-- ============================================================== -->
    <!-- Preloader - style you can find in spinners.css -->
    <!-- ============================================================== -->
    <div class="preloader">
        <div class="lds-ripple">
            <div class="lds-pos"></div>
            <div class="lds-pos"></div>
        </div>
    </div>
    <!-- ============================================================== -->
    <!-- Main wrapper - style you can find in pages.scss -->
    <!-- ============================================================== -->
    <div id="main-wrapper" data-layout="vertical" data-navbarbg="skin6" data-sidebartype="full"
        data-sidebar-position="absolute" data-header-position="absolute" data-boxed-layout="full">
        <!-- ============================================================== -->
        <!-- Topbar header - style you can find in pages.scss -->
        <!-- ============================================================== -->
        <header class="topbar" data-navbarbg="skin6">
            <nav class="navbar top-navbar navbar-expand-md navbar-dark">
                <div class="navbar-header" data-logobg="skin6">
                    <!-- ============================================================== -->
                    <!-- Logo -->
                    <!-- ============================================================== -->
                    <a class="navbar-brand" href="{{ url_for('dash.index') }}">
                        <!-- Logo text -->
                        <span class="logo-text" style="color:#4684ba; font-size: 2rem;font-weight: 300;">
                            <!-- dark Logo text -->
                            Omi's Class
                        </span>
                    </a>
                    <!-- ============================================================== -->
                    <!-- End Logo -->
                    <!-- ============================================================== -->
                    <!-- ============================================================== -->
                    <!-- toggle and nav items -->
                    <!-- ============================================================== -->
                    <a class="nav-toggler waves-effect waves-light text-dark d-block d-md-none"
                        href="javascript:void(0)"><i class="ti-menu ti-close"></i></a>
                </div>
                <!-- ============================================================== -->
                <!-- End Logo -->
                <!-- ============================================================== -->
                <div class="navbar-collapse collapse" id="navbarSupportedContent" data-navbarbg="skin5">

                    <!-- ============================================================== -->
                    <!-- toggle and nav items -->
                    <!-- ============================================================== -->
                    <ul class="navbar-nav me-auto mt-md-0 ">
                        <!-- ============================================================== -->
                        <!-- Search -->
                        <!-- ============================================================== -->

                        <!-- <li class="nav-item hidden-sm-down">
                            <form class="app-search ps-3">
                                <input type="text" class="form-control" placeholder="Search for..."> <a
                                    class="srh-btn"><i class="ti-search"></i></a>
                            </form>
                        </li> -->
                    </ul>

                    <!-- ============================================================== -->
                    <!-- Right side toggle and nav items -->
                    <!-- ============================================================== -->
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item dropdown">
                          <a class="nav-link dropdown-toggle d-flex align-items-center"
                             href="#"
                             id="navbarDropdown"
                             role="button"
                             data-bs-toggle="dropdown"
                             aria-expanded="false">
                            <img src="{{ url_for('static', filename='assets/images/profile_photos/profile_1.jpg') }}"
                                 alt="user"
                                 class="profile-pic me-2"
                                 
                                 />
                      
                            <span>Bwalya Chanda</span>
                          </a>
                      
                          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
                      
                            <li>
                              <a class="dropdown-item d-flex align-items-center" href="{{ url_for('dash.view_profile') }}">
                                <i class="fa fa-user me-3"></i> Profile
                              </a>
                            </li>
                      
                            <li>
                              <a class="dropdown-item d-flex align-items-center" href="{{ url_for('dash.settings') }}">
                                <i class="fa fa-cog me-3"></i> Settings
                              </a>
                            </li>
                      
                            <li><hr class="dropdown-divider"></li>
                      
                            <li>
                              <a class="dropdown-item d-flex align-items-center text-danger" id="logoutDropdown" href="{{ url_for('auth.logout') }}">
                                <i class="fas fa-sign-out-alt me-3"></i> Logout
                              </a>
                            </li>
                      
                          </ul>
                        </li>
                      </ul>
                      
                </div>
            </nav>
        </header>
        <!-- ============================================================== -->
        <!-- End Topbar header -->
        <!-- ============================================================== -->
        <!-- ============================================================== -->
        <!-- Left Sidebar - style you can find in sidebar.scss  -->
        <!-- ============================================================== -->
        <aside class="left-sidebar" data-sidebarbg="skin6">
            <!-- Sidebar scroll-->
            <div class="scroll-sidebar">
                <!-- Sidebar navigation-->
                <nav class="sidebar-nav">
                    <ul id="sidebarnav">
                        {% if current_user.is_authenticated and current_user.role in ["admin", "teacher"] %}
                        <!-- Dashboard -->
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link" href="{{ url_for('dash.index') }}" aria-expanded="false">
                                <i class="me-3 far fa-clock fa-fw" aria-hidden="true"></i>
                                <span class="hide-menu">Dashboard</span>
                            </a>
                        </li>
                        {% endif %}
                
                        {% if current_user.is_authenticated and current_user.role in ["admin", "teacher"] %}
                        <!-- Attendance -->
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link has-arrow" href="attendance.html" aria-expanded="false">
                                <i class="me-3 fa fa-check-square" aria-hidden="true"></i>
                                <span class="hide-menu">Attendance</span>
                            </a>
                            <ul class="collapse first-level" aria-expanded="false">
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.create_attendance') }}" class="sidebar-link">
                                        <span class="hide-menu">Create Attendance</span>
                                    </a>
                                </li>
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.view_attendances') }}" class="sidebar-link">
                                        <span class="hide-menu">View All Attendance</span>
                                    </a>
                                </li>
                            </ul>
                        </li>
                        {% endif %}
                
                        {% if  current_user.is_authenticated and current_user.role == "teacher" %}
                        <!-- Grades -->
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link has-arrow" href="javascript:void(0)" aria-expanded="false">
                                <i class="me-3 fa fa-graduation-cap" aria-hidden="true"></i>
                                <span class="hide-menu">Grades</span>
                            </a>
                            <ul class="collapse first-level" aria-expanded="false">
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.create_grade') }}" class="sidebar-link"><span class="hide-menu">Create Grade</span></a>
                                </li>
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.view_grades') }}" class="sidebar-link"><span class="hide-menu">View All Grades</span></a>
                                </li>
                            </ul>
                        </li>
                        {% endif %}
                
                        {% if  current_user.is_authenticated and current_user.role == "teacher" %}
                        <!-- Assignments -->
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link has-arrow" href="javascript:void(0)" aria-expanded="false">
                                <i class="fa fa-lock me-3" aria-hidden="true"></i>
                                <span class="hide-menu">Assignments</span>
                            </a>
                            <ul class="collapse first-level" aria-expanded="false">
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.create_assignment') }}" class="sidebar-link"><span class="hide-menu">Create Assignment</span></a>
                                </li>
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.view_assignment') }}" class="sidebar-link"><span class="hide-menu">View All Assignments</span></a>
                                </li>
                            </ul>
                        </li>
                        {% endif %}
                
                        {% if current_user.is_authenticated and current_user.role in ["admin", "teacher"] %}
                        <!-- Students Management -->
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link has-arrow" href="javascript:void(0)" aria-expanded="false">
                                <i class="me-3 fa fa-users" aria-hidden="true"></i>
                                <span class="hide-menu">Students Management</span>
                            </a>
                            <ul class="collapse first-level" aria-expanded="false">
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.view_students') }}" class="sidebar-link"><span class="hide-menu">View Students</span></a>
                                </li>
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.view_cms_students') }}" class="sidebar-link"><span class="hide-menu">View CMS Students</span></a>
                                </li>
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.create_student_school_record') }}" class="sidebar-link"><span class="hide-menu">Add Student</span></a>
                                </li>
                            </ul>
                        </li>
                        {% endif %}

                        {% if current_user.is_authenticated and current_user.role in ["admin", "student"] %}
                        <!-- Students Assignment Submission -->
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link has-arrow"
                            href="javascript:void(0)" aria-expanded="false">
                                <i class="me-3 fa fa-upload"></i>
                                <span class="hide-menu">Assignment Submission</span>
                            </a>

                            <ul class="collapse first-level" aria-expanded="false">

                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.view_assignment_submissions') }}" class="sidebar-link">
                                        <i class="fa fa-eye me-2"></i>
                                        <span class="hide-menu">Submitted Assignments </span>
                                    </a>
                                </li>

                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.create_assignment_submission') }}" class="sidebar-link">
                                        <i class="fa fa-plus me-2"></i>
                                        <span class="hide-menu">Submit Assignment</span>
                                    </a>
                                </li>

                            </ul>
                        </li>
                        {% endif %}

                        {% if  current_user.is_authenticated and current_user.role == "teacher" %}
                         <!-- Admin Management -->
                         <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link has-arrow" href="javascript:void(0)" aria-expanded="false">
                                <i class="fa fa-user-secret me-3" aria-hidden="true"></i>
                                <span class="hide-menu">Admin Management</span>
                            </a>
                            <ul class="collapse first-level" aria-expanded="false">
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.view_admins') }}" class="sidebar-link"><span class="hide-menu">View Admin</span></a>
                                </li>
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.create_admin') }}" class="sidebar-link"><span class="hide-menu">Add Admin</span></a>
                                </li>
                            </ul>
                        </li>
                        {% endif %}

                        {% if  current_user.is_authenticated and current_user.role == "student" %}
                            <!-- Students Only -->
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link has-arrow" href="javascript:void(0)" aria-expanded="false">
                                <i class="fa fa-user-circle me-3"></i>
                                <span class="hide-menu">Student</span>
                            </a>
                            <ul class="collapse first-level" aria-expanded="false">
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.view_student_grades') }}" class="sidebar-link"><span class="hide-menu">View grades</span></a>
                                </li>
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.view_student_assignments') }}" class="sidebar-link"><span class="hide-menu">View  Assignments</span></a>
                                </li>
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.view_student_attendances') }}" class="sidebar-link"><span class="hide-menu">View Attendances</span></a>
                                </li>
                            </ul>
                        </li>
                        {% endif %}
                        
                
                        {% if current_user.is_authenticated %}
                        <!-- Profile -->
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link" href="{{ url_for('dash.view_profile') }}" aria-expanded="false">
                                <i class="me-3 fa fa-user" aria-hidden="true"></i>
                                <span class="hide-menu">Profile</span>
                            </a>
                        </li>
                            
                        {% endif %}
                        
                
                        {% if current_user.is_authenticated and current_user.role in ["admin", "teacher"] %}
                            <!-- Settings -->
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link" href="{{ url_for('dash.settings') }}" aria-expanded="false">
                                <i class="me-3 fa fa-cog" aria-hidden="true"></i>
                                <span class="hide-menu">Settings</span>
                            </a>
                        </li>
                        {% endif %}
                
                        {% if current_user.is_authenticated %}
                            <!-- Logout -->
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link"  id="logoutSidebar" aria-expanded="false">
                                <i class="me-3 fa fa-sign-out-alt" aria-hidden="true"></i>
                                <span class="hide-menu">Logout</span>
                            </a>
                        </li>
                        {% endif %}
                    </ul>
                </nav>
                <!-- End Sidebar navigation -->
            </div>
            <!-- End Sidebar scroll-->
        </aside>
        <!-- ============================================================== -->
        <!-- End Left Sidebar - style you can find in sidebar.scss  -->
        <!-- ============================================================== -->
        <!-- ============================================================== -->
        <!-- Page wrapper  -->
        <!-- ============================================================== -->
        <div class="page-wrapper">
            <!-- TOAST -->
            <div id="toast">
                <span id="toast-message"></span>
                <span class="close-toast" onclick="hideToast()">&times;</span>
            </div>
           
            {% block content %}
              
            {% endblock content %}
          


	          <footer class="footer text-center">
                Â© {{ current_year}} Classroom Management Dashbaord Created by <a href="https://www.naomiphiri.com/">Naomi Phiri</a> 
            </footer>
            <!-- ============================================================== -->
            <!-- End footer -->
            <!-- ============================================================== -->
        </div>
        <!-- ============================================================== -->
        <!-- End Page wrapper  -->
        <!-- ============================================================== -->
    </div>
    <!-- ============================================================== -->
    <!-- End Wrapper -->
    <!-- ============================================================== -->
    <!-- ============================================================== -->
    <!-- auth js -->
    <script src="{{ url_for('auth.static', filename='js/auth.js') }}"></script>
   
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
     <!-- custom chart -->
    <script src="{{ url_for('static', filename='js/custom_chart.js') }}"></script>


    <!-- custom flot -->
    <!-- jQuery (required for Flot) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Flot.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.categories.min.js"></script>
    <script src="{{ url_for('static', filename='js/custom_float.js') }}"></script>

    


    <!-- All Jquery -->
    <!-- ============================================================== -->
    <script src="{{ url_for('static', filename='assets/plugins/jquery/dist/jquery.min.js') }}"></script>
    <!-- Bootstrap tether Core JavaScript -->
    <script src="{{ url_for('static', filename='assets/plugins/bootstrap/dist/js/bootstrap.bundle.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/app-style-switcher.js') }}"></script>
    <!--Wave Effects -->
    <script src="{{ url_for('static', filename='js/waves.js') }}"></script>
    <!--Menu sidebar -->
    <script src="{{ url_for('static', filename='js/sidebarmenu.js') }}"></script>
    <!--Custom JavaScript -->
    <script src="{{ url_for('static', filename='js/custom.js') }}"></script>
    <!--This page JavaScript -->
    <!--flot chart-->
    <script src="{{ url_for('static', filename='assets/plugins/flot/jquery.flot.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/plugins/flot.tooltip/js/jquery.flot.tooltip.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/pages/dashboards/dashboard1.js') }}"></script>

    
 <!-- ---------- Chat widget HTML ---------- -->
 <button id="chatToggleBtn" class="chat-widget-btn" aria-label="Open chat" title="Chat with Omi">
  <!-- simple chat icon svg -->
  <svg class="chat-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
    <path d="M4 4h16v10H6l-2 2V4z" fill="#fff"></path>
  </svg>
</button>

<div id="chatPanel" class="chat-panel" role="dialog" aria-modal="false" aria-hidden="true">
  <div class="chat-header">
    <img src="{{ url_for('static', filename='assets/favicon/learning.png') }}" alt="bot" />
    <div style="flex:1;">
      <div class="title">Omi â€” Classroom Bot</div>
      <div class="subtitle">Ask about attendance, assignments, or just say hi</div>
    </div>
    <div style="display:flex; gap:8px; align-items:center;">
      <button id="minimizeChat" class="btn btn-sm btn-light" title="Minimize">â€”</button>
      <button id="closeChat" class="btn btn-sm btn-outline-light text-dark" title="Close">âœ•</button>
    </div>
  </div>

  <div id="chatBody" class="chat-body" role="log" aria-live="polite">
    <!-- messages appended here -->
    <div class="chat-msg bot">Hello ðŸ‘‹ â€” I'm Omi. How can I help today?</div>
  </div>

  <div class="chat-input-row">
    <input id="chatInput" type="text" placeholder="Type your message..." aria-label="Message input" />
    <button id="chatSendBtn" title="Send">Send</button>
  </div>
</div>



<script>
  // ---------- Dropdown behavior cleanup ----------
  (function () {
    // make sure collapse toggles work in Monster theme
    document.querySelectorAll('.sidebar-item > .sidebar-link.has-arrow').forEach(btn => {
      btn.addEventListener('click', function (e) {
        const parent = this.parentElement;
        const submenu = parent.querySelector('.collapse.first-level');
        if (!submenu) return;
        e.preventDefault();
        submenu.classList.toggle('show');
      });
    });
  })();

  // ---------- Chat widget behavior ----------
  (function () {
    const toggleBtn = document.getElementById('chatToggleBtn');
    const panel = document.getElementById('chatPanel');
    const chatBody = document.getElementById('chatBody');
    const chatInput = document.getElementById('chatInput');
    const sendBtn = document.getElementById('chatSendBtn');
    const closeBtn = document.getElementById('closeChat');
    const minimizeBtn = document.getElementById('minimizeChat');

    function openChat() {
      panel.classList.add('show');
      panel.setAttribute('aria-hidden', 'false');
      chatInput.focus();
    }
    function closeChat() {
      panel.classList.remove('show');
      panel.setAttribute('aria-hidden', 'true');
    }
    // toggle
    toggleBtn.addEventListener('click', function () {
      if (panel.classList.contains('show')) {
        closeChat();
      } else {
        openChat();
      }
    });
    // close & minimize
    closeBtn.addEventListener('click', closeChat);
    minimizeBtn.addEventListener('click', closeChat);

    // send message
    function appendMessage(text, who = 'bot') {
      const div = document.createElement('div');
      div.className = 'chat-msg ' + (who === 'user' ? 'user' : 'bot');
      div.textContent = text;
      chatBody.appendChild(div);
      chatBody.scrollTop = chatBody.scrollHeight;
    }

    async function sendMessage() {
      const text = chatInput.value.trim();
      if (!text) return;
      appendMessage(text, 'user');
      chatInput.value = '';
      chatInput.disabled = true;
      sendBtn.disabled = true;

      // Example: local placeholder response while you connect server
      appendMessage('Typing...', 'bot');
      // remove the 'Typing...' after delay and replace with response
      setTimeout(() => {
        // remove last bot 'Typing...' and add final
        const last = chatBody.querySelectorAll('.chat-msg.bot');
        const lastBot = last[last.length - 1];
        if (lastBot && lastBot.textContent === 'Typing...') {
          lastBot.textContent = "Thanks â€” I received: " + text + ". (This is a demo reply.)";
        }
        chatInput.disabled = false;
        sendBtn.disabled = false;
        chatInput.focus();
        chatBody.scrollTop = chatBody.scrollHeight;
      }, 900);

      
      try {
        const resp = await fetch('/dash/chatbot', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ message: text })
        });
        const data = await resp.json();
        // replace the 'Typing...' placeholder with real reply
        const last = chatBody.querySelectorAll('.chat-msg.bot');
        const lastBot = last[last.length - 1];
        if (lastBot && lastBot.textContent === 'Typing...') lastBot.textContent = data.reply || 'No reply';
      } catch (err) {
        const last = chatBody.querySelectorAll('.chat-msg.bot');
        const lastBot = last[last.length - 1];
        if (lastBot && lastBot.textContent === 'Typing...') lastBot.textContent = 'Sorry â€” failed to contact server.';
      } finally {
        chatInput.disabled = false;
        sendBtn.disabled = false;
        chatInput.focus();
      }
      
    }

    // Enter to send
    chatInput.addEventListener('keydown', function (e) {
      if (e.key === 'Enter') {
        e.preventDefault();
        sendMessage();
      }
    });
    sendBtn.addEventListener('click', sendMessage);

    // click outside panel to close (small screens)
    document.addEventListener('click', function (e) {
      if (window.innerWidth <= 480) {
        if (!panel.contains(e.target) && !toggleBtn.contains(e.target) && panel.classList.contains('show')) {
          closeChat();
        }
      }
    });
  })();

  
</script>


  
</body>

</html>