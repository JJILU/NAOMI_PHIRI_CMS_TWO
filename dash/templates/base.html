
<!DOCTYPE html>
<html dir="ltr" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Tell the browser to be responsive to screen width -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords"
        content="wrappixel, admin dashboard, html css dashboard, web dashboard, bootstrap 5 admin, bootstrap 5, css3 dashboard, bootstrap 5 dashboard, Monsterlite admin bootstrap 5 dashboard, frontend, responsive bootstrap 5 admin template, Monster admin lite design, Monster admin lite dashboard bootstrap 5 dashboard template">
    <meta name="description"
        content="Monster Lite is powerful and clean admin dashboard template, inpired from Bootstrap Framework">
    <meta name="robots" content="noindex,nofollow">
    <title>Classroom Management System</title>
    <link rel="canonical" href="https://www.wrappixel.com/templates/monster-admin-lite/" />
    <!-- Custom CSS -->
    <link href="{{ url_for('static', filename='assets/plugins/chartist/dist/chartist.min.css') }}" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="{{ url_for('static', filename='css/style.min.css') }}" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/dash.css') }}" rel="stylesheet">
     <!-- Favicon icon -->
     <link rel="icon" href="{{ url_for('static', filename='assets/favicon/learning.png') }}" type="image/png">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<style>
 /* ---------- Layout helpers ---------- */
 :root {
      --brand: #4684ba;
      --brand-soft: #72bde8;
      --chat-bg: #ffffff;
      --chat-primary: var(--brand);
      --chat-text: #222;
      --border-radius: 0.5rem;
      --elev: 0 8px 24px rgba(0, 0, 0, 0.12);
    }
    /* Make all cards equal height */
  .card {
      height: 100%;
      display: flex;
      flex-direction: column;
  }
  
  /* Make the image fixed height and crop excess */
  .card-img-top {
      height: 180px;
      width: 100%;
      object-fit: cover;
  }
  
  /* Prevent overflow in the card-body */
  .card-body {
      flex: 1;
      display: flex;
      flex-direction: column;
  }
  
  /* Ellipsis for overflow text */
  .card-body h3,
  .card-body ul li {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
  }
  
  
  /* Fix dropdown clipping if not already fixed */
  .navbar-collapse {
      overflow: visible !important;
  }
  
  
/* ======== 100% FIX ‚Äì Bootstrap dropdown visible ======== */

/* DO NOT control visibility here */
.dropdown-menu {
    position: absolute;
    z-index: 1055 !important; /* Bootstrap standard */

    /* styling */
    background: linear-gradient(135deg, #72bde8, #4684ba) !important;
    min-width: 220px !important;
    border-radius: 0.5rem;
    padding: 0.5rem 0;
    box-shadow: 0 0.5rem 1rem rgba(0,0,0,0.15);
}

/* ‚ùå DO NOT add display rules */
/* Bootstrap JS adds/removes .show itself */

/* Fix Monster Admin clipping */
.topbar,
.topbar .navbar,
.topbar .navbar-collapse {
    overflow: visible !important;
}

/* Dropdown items */
.navbar .dropdown-menu .dropdown-item {
    color: #fff !important;
    padding: 0.5rem 1.25rem;
    font-weight: 500;
}

.navbar .dropdown-menu .dropdown-item:hover {
    background-color: rgba(255, 255, 255, 0.2) !important;
    color: #fff !important;
}

/* Divider */
.navbar .dropdown-menu .dropdown-divider {
    border-top: 1px solid rgba(255,255,255,0.3);
    margin: 0.25rem 0;
}

/* Profile image */
.navbar .dropdown-toggle img.profile-pic {
    width: 48px !important;
    height: 48px !important;
    border-radius: 50% !important;
    object-fit: cover !important;
    display: block !important;
}

/* Toggle alignment */
.navbar .dropdown-toggle {
    display: flex !important;
    align-items: center !important;
    gap: 10px;
    min-height: 60px;
} 






/* FIX: Add spacing between all dashboard rows */
.container-fluid .row {
    margin-bottom: 25px !important;
}


/* ----------- TOAST NOTIFICATIONS CSS  ---------------*/

#toast {
  position: fixed;
  top: 20px;
  left: 50%;
  transform: translateX(-50%) translateY(-20px);
  min-width: 250px;
  max-width: 350px;
  padding: 16px 24px;
  border-radius: 12px;
  color: #fff;
  font-weight: 500;
  font-size: 16px;
  background: rgba(39, 39, 39, 0.85); /* dark semi-transparent, suits your theme */
  box-shadow: 0 4px 15px rgba(0,0,0,0.3);
  opacity: 0;
  pointer-events: none;
  transition: all 0.4s ease;
  z-index: 9999;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

#toast.show {
  opacity: 1;
  transform: translateX(-50%) translateY(0);
  pointer-events: auto;
}

#toast.success {
  background: rgba(40, 167, 69, 0.9);
}

#toast.error {
  background: rgba(220, 53, 69, 0.9);
}

#toast.info {
  background: rgba(0, 123, 255, 0.9);
}

#toast .close-toast {
  margin-left: 15px;
  cursor: pointer;
  font-weight: bold;
}


 /* ---------- Chat widget CSS ---------- */
 .chat-widget-btn {
      position: fixed;
      right: 22px;
      bottom: 22px;
      width: 64px;
      height: 64px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--brand-soft), var(--brand));
      box-shadow: 0 10px 30px rgba(70,132,186,.22);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 20000;
      border: none;
      transition: transform .15s ease;
    }
    .chat-widget-btn:active { transform: scale(.98); }

    .chat-widget-btn .chat-icon { width: 28px; height: 28px; filter: drop-shadow(0 2px 6px rgba(0,0,0,.12)); }

    /* Chat panel  */
    .chat-panel {
      position: fixed;
      right: 22px;
      bottom: 100px;
      width: 360px;
      max-width: calc(100% - 44px);
      height: 520px;
      display: flex;
      flex-direction: column;
      border-radius: 12px;
      background: var(--chat-bg);
      box-shadow: var(--elev);
      overflow: hidden;
      z-index: 20000;
      transform-origin: bottom right;
      transition: transform .18s cubic-bezier(.2,.9,.3,1), opacity .16s ease;
      opacity: 0;
      visibility: hidden;
    }

    .chat-panel.show { opacity: 1; visibility: visible; transform: translateY(0) scale(1); }

    .chat-header {
      background: linear-gradient(90deg, var(--brand), #2f6f99);
      color: #fff;
      padding: 12px 14px;
      display:flex;
      align-items:center;
      gap: 12px;
    }
    .chat-header img { width:40px; height:40px; border-radius:50%; object-fit:cover; }
    .chat-header .title { font-weight:600; }
    .chat-header .subtitle { font-size: .85rem; opacity:.9; }

    .chat-body {
      padding: 12px;
      background: #f8fbff;
      flex: 1;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .chat-msg { max-width: 78%; padding: 10px 12px; border-radius: 12px; font-size: .95rem; line-height:1.3; }
    .chat-msg.bot { background: #fff; align-self: flex-start; box-shadow: 0 4px 16px rgba(0,0,0,0.04); color: var(--chat-text); }
    .chat-msg.user { background: linear-gradient(135deg, var(--brand-soft), var(--brand)); color:#fff; align-self: flex-end; }

    .chat-input-row {
      display:flex;
      gap:8px;
      padding: 10px;
      border-top: 1px solid #eef4fb;
      background: #fff;
    }
    .chat-input-row input[type="text"] {
      flex:1;
      border-radius: 999px;
      border: 1px solid #e6eef7;
      padding: 10px 14px;
      outline: none;
      font-size: .95rem;
    }
    .chat-input-row button {
      background: var(--chat-primary);
      color: #fff;
      border-radius: 999px;
      border: none;
      padding: 8px 12px;
    }

    /* Small screens: use full width bottom */
    @media (max-width: 480px) {
      .chat-panel { right: 12px; left: 12px; bottom: 82px; width: auto; height: 62vh; }
      .chat-widget-btn { right: 12px; bottom: 12px; }
    }




</style>
</head>

<body>
    
    <!-- ============================================================== -->
    <!-- Preloader - style you can find in spinners.css -->
    <!-- ============================================================== -->
    <div class="preloader">
        <div class="lds-ripple">
            <div class="lds-pos"></div>
            <div class="lds-pos"></div>
        </div>
    </div>
    <!-- ============================================================== -->
    <!-- Main wrapper - style you can find in pages.scss -->
    <!-- ============================================================== -->
    <div id="main-wrapper" data-layout="vertical" data-navbarbg="skin6" data-sidebartype="full"
        data-sidebar-position="absolute" data-header-position="absolute" data-boxed-layout="full">
        <!-- ============================================================== -->
        <!-- Topbar header - style you can find in pages.scss -->
        <!-- ============================================================== -->
        <header class="topbar" data-navbarbg="skin6">
            <nav class="navbar top-navbar navbar-expand-md navbar-dark">
                <div class="navbar-header" data-logobg="skin6">
                    <!-- ============================================================== -->
                    <!-- Logo -->
                    <!-- ============================================================== -->
                    <a class="navbar-brand" href="{{ url_for('dash.index') }}">
                        <!-- Logo text -->
                        <span class="logo-text" style="color:#4684ba; font-size: 2rem;font-weight: 300;">
                            <!-- dark Logo text -->
                            Omi's Class
                        </span>
                    </a>
                    <!-- ============================================================== -->
                    <!-- End Logo -->
                    <!-- ============================================================== -->
                    <!-- ============================================================== -->
                    <!-- toggle and nav items -->
                    <!-- ============================================================== -->
                    <a class="nav-toggler waves-effect waves-light text-dark d-block d-md-none"
                        href="javascript:void(0)"><i class="ti-menu ti-close"></i></a>
                </div>
                <!-- ============================================================== -->
                <!-- End Logo -->
                <!-- ============================================================== -->
                <div class="navbar-collapse collapse" id="navbarSupportedContent" data-navbarbg="skin5">

                    <!-- ============================================================== -->
                    <!-- toggle and nav items -->
                    <!-- ============================================================== -->
                    <ul class="navbar-nav me-auto mt-md-0 ">
                        <!-- ============================================================== -->
                        <!-- Search -->
                        <!-- ============================================================== -->

                        <!-- <li class="nav-item hidden-sm-down">
                            <form class="app-search ps-3">
                                <input type="text" class="form-control" placeholder="Search for..."> <a
                                    class="srh-btn"><i class="ti-search"></i></a>
                            </form>
                        </li> -->
                    </ul>

                    <!-- ============================================================== -->
                    <!-- Right side toggle and nav items -->
                    <!-- ============================================================== -->
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item dropdown">
                      
                          {% if current_user.role == "teacher" %}
                          {% set record = current_user.teacherschoolrecord %}
                          <a class="nav-link dropdown-toggle d-flex align-items-center"
                             href="javascript:void(0)"
                             id="userDropdown"
                             role="button"
                             >
                      
                              <img src="{{ url_for('dash.uploaded_avator_photo',
                                  filename=record.teacher_avator.filename if record.teacher_avator else 'https://res.cloudinary.com/db3wztm1j/image/upload/v1765869688/placeholder_laxheb.jpg') }}"
                                  class="profile-pic me-2"
                                  width="40" height="40">
                      
                              <span>{{ record.first_name }} {{ record.last_name }}</span>
                          </a>
                      
                          {% elif current_user.role == "admin" %}
                          {% set record = current_user.admin %}
                          <a class="nav-link dropdown-toggle d-flex align-items-center"
                             href="javascript:void(0)"
                             id="userDropdown"
                             role="button"
                             >
                      
                              <img src="{{ url_for('dash.uploaded_avator_photo',
                                  filename=record.student_avator.filename if record.student_avator else 'https://res.cloudinary.com/db3wztm1j/image/upload/v1765869688/placeholder_laxheb.jpg') }}"
                                  class="rounded-circle me-2"
                                  width="40" height="40">
                      
                              <span>{{ record.first_name }} {{ record.last_name }}</span>
                          </a>
                      
                          {% elif current_user.role == "student" %}
                          {% set record = current_user.student %}
                          <a class="nav-link dropdown-toggle d-flex align-items-center"
                             href="javascript:void(0)"
                             id="userDropdown"
                             role="button"
                             >
                      
                              <img src="{{ url_for('dash.uploaded_avator_photo',
                                  filename=record.student_avator.filename if record.student_avator else 'https://res.cloudinary.com/db3wztm1j/image/upload/v1765869688/placeholder_laxheb.jpg') }}"
                                  class="rounded-circle me-2"
                                  width="40" height="40">
                      
                              <span>{{ record.first_name }} {{ record.last_name }}</span>
                          </a>
                          {% endif %}
                      
                          <!-- DROPDOWN MENU -->
                          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                            <li>
                              <a class="dropdown-item d-flex align-items-center"
                                 href="{{ url_for('dash.view_profile') }}">
                                <i class="fa fa-user me-3"></i> Profile
                              </a>
                            </li>
                      
                            <li><hr class="dropdown-divider"></li>
                      
                            <li>
                              <a class="dropdown-item d-flex align-items-center text-danger"
                                 href="{{ url_for('auth.logout') }}">
                                <i class="fas fa-sign-out-alt me-3"></i> Logout
                              </a>
                            </li>
                          </ul>
                      
                        </li>
                      </ul>
                      
                      
                </div>
            </nav>
        </header>
        <!-- ============================================================== -->
        <!-- End Topbar header -->
        <!-- ============================================================== -->
        <!-- ============================================================== -->
        <!-- Left Sidebar - style you can find in sidebar.scss  -->
        <!-- ============================================================== -->
        <aside class="left-sidebar" data-sidebarbg="skin6">
            <!-- Sidebar scroll-->
            <div class="scroll-sidebar">
                <!-- Sidebar navigation-->
                <nav class="sidebar-nav">
                    <ul id="sidebarnav">
                        {% if current_user.is_authenticated and current_user.role in ["admin", "teacher"] %}
                        <!-- Dashboard -->
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link" href="{{ url_for('dash.index') }}" aria-expanded="false">
                                <i class="me-3 far fa-clock fa-fw" aria-hidden="true"></i>
                                <span class="hide-menu">Dashboard</span>
                            </a>
                        </li>
                        {% endif %}
                        
                        {% if current_user.is_authenticated and current_user.role in ["admin", "teacher"] %}
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link has-arrow" 
                              href="javascript:void(0)" aria-expanded="false">
                                <i class="me-3 fa fa-check-square"></i>
                                <span class="hide-menu">Attendance</span>
                            </a>
                            <ul class="collapse first-level">

                                <!-- See all students to view their attendance -->
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.view_attendance_students') }}" class="sidebar-link">
                                        <span class="hide-menu">View Students Attendance</span>
                                    </a>
                                </li>

                            </ul>
                        </li>
                        {% endif %}



                        {% if current_user.is_authenticated and current_user.role == "teacher" %}
                        <!-- Grades -->
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link has-arrow" href="javascript:void(0)" aria-expanded="false">
                                <i class="me-3 fa fa-graduation-cap" aria-hidden="true"></i>
                                <span class="hide-menu">Grades</span>
                            </a>
                            <ul class="collapse first-level" aria-expanded="false">
                                <!-- NOTE: Create Grade is now student-specific, so link goes to student list first -->
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.view_grades') }}" class="sidebar-link">
                                        <span class="hide-menu">Add / View Grades</span>
                                    </a>
                                </li>
                            </ul>
                        </li>
                        {% endif %}

                
                        
                        {% if current_user.is_authenticated and current_user.role == "teacher" %}
                        <!-- Assignments -->
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link has-arrow" href="javascript:void(0)" aria-expanded="false">
                                <i class="fa fa-lock me-3" aria-hidden="true"></i>
                                <span class="hide-menu">Assignments</span>
                            </a>
                            <ul class="collapse first-level" aria-expanded="false">
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.create_assignment') }}" class="sidebar-link">
                                        <span class="hide-menu">Create Assignment</span>
                                    </a>
                                </li>
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.list_assignments') }}" class="sidebar-link">
                                        <span class="hide-menu">View All Assignments</span>
                                    </a>
                                </li>
                            </ul>
                        </li>
                        {% endif %}


                          
                        <!-- ===================== ASSIGNMENT SUBMISSIONS MENU ===================== -->
                        {% if current_user.is_authenticated %}
                        <!-- Assignment Submission -->
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link has-arrow"
                              href="javascript:void(0)" aria-expanded="false">
                                <i class="fa fa-paper-plane me-3" aria-hidden="true"></i>
                                <span class="hide-menu">Assignment Submissions</span>
                            </a>

                            <ul class="collapse first-level" aria-expanded="false">

                                {# ------------------ STUDENT MENU ------------------ #}
                                {% if current_user.student_school_record_id %}
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.student_submission_assignments') }}" class="sidebar-link">
                                        <span class="hide-menu">My Assignments</span>
                                    </a>
                                </li>
                                {% endif %}

                                {# ------------------ ADMIN MENU ------------------ #}
                                {% if current_user.role == "admin" %}
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.student_submission_assignments') }}" class="sidebar-link">
                                        <span class="hide-menu">Student Assignments</span>
                                    </a>
                                </li>

                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.admin_view_class_submissions') }}" class="sidebar-link">
                                        <span class="hide-menu">Class Submissions</span>
                                    </a>
                                </li>
                                {% endif %}

                                {# ------------------ TEACHER MENU ------------------ #}
                                {% if current_user.role == "teacher" %}

                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.teacher_submitted') }}" class="sidebar-link">
                                        <span class="hide-menu">View Submissions</span>
                                    </a>
                                </li>
                                {% endif %}

                            </ul>
                        </li>
                        {% endif %}

                        {% if current_user.is_authenticated and current_user.role == "teacher" %}
                        <!-- Study Materials Teacher -->
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark has-arrow" href="javascript:void(0)">
                                <i class="me-3 fa fa-book" aria-hidden="true"></i>
                                <span class="hide-menu">Study Material</span>
                            </a>
                            <ul class="collapse first-level">
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.create_study_material') }}" class="sidebar-link">
                                        <span class="hide-menu">Create Study Material</span>
                                    </a>
                                </li>
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.list_study_material') }}" class="sidebar-link">
                                        <span class="hide-menu">View Study Material</span>
                                    </a>
                                </li>
                            </ul>
                        </li>
                        {% endif %}
                    
                        {% if current_user.is_authenticated and current_user.role in ["admin", "student"] %}
                        <!-- Study Materials Student & Admins -->
                        <li class="sidebar-item">
                            <a href="{{ url_for('dash.list_study_material') }}" class="sidebar-link">
                                <i class="me-3 fa fa-book" aria-hidden="true"></i>
                                <span class="hide-menu">Study Material</span>
                            </a>
                        </li>
                        {% endif %}

                        {% if current_user.is_authenticated and current_user.role in ["admin", "teacher"] %}
                        <!-- STUDENT REPORTS -->
                        <li class="sidebar-item">
                            <a class="sidebar-link" href="{{ url_for('dash.report_students') }}">
                                <i class="me-3 fa fa-chart-bar"></i>
                                <span class="hide-menu">Student Reports</span>
                            </a>
                        </li>
                        {% endif %}


                        {% if current_user.is_authenticated and current_user.role in ["admin", "teacher"] %}
                        <!-- Admin Management -->
                        <li class="sidebar-item">
                            <a class="sidebar-link has-arrow waves-effect waves-dark" href="javascript:void(0)" aria-expanded="false">
                                <i class="me-3 fa fa-user-secret" aria-hidden="true"></i>
                                <span class="hide-menu">Admin Management</span>
                            </a>
                            <ul class="collapse first-level" aria-expanded="false">
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.create_admin') }}" class="sidebar-link">
                                        <span class="hide-menu">Create Admin</span>
                                    </a>
                                </li>
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.view_school_admins') }}" class="sidebar-link">
                                        <span class="hide-menu">View School Admins</span>
                                    </a>
                                </li>
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.view_cms_admins') }}" class="sidebar-link">
                                        <span class="hide-menu">View CMS Admins</span>
                                    </a>
                                </li>
                            </ul>
                        </li>
                        {% endif %}


                        

                
                        {% if current_user.is_authenticated and current_user.role in ["admin", "teacher"] %}
                        <!-- Students Management -->
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link has-arrow" href="javascript:void(0)" aria-expanded="false">
                                <i class="me-3 fa fa-users" aria-hidden="true"></i>
                                <span class="hide-menu">Students Management</span>
                            </a>
                            <ul class="collapse first-level" aria-expanded="false">
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.view_students') }}" class="sidebar-link"><span class="hide-menu">View Students</span></a>
                                </li>
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.view_cms_students') }}" class="sidebar-link"><span class="hide-menu">View CMS Students</span></a>
                                </li>
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.create_student_school_record') }}" class="sidebar-link"><span class="hide-menu">Add Student</span></a>
                                </li>
                            </ul>
                        </li>
                        {% endif %}

                        

                        <!-- ================= Student Menu ================= -->
                        {% if current_user.is_authenticated and current_user.student_school_record %}
                        <li class="sidebar-item">
                        <a class="sidebar-link waves-effect waves-dark sidebar-link has-arrow" 
                            href="javascript:void(0)" aria-expanded="false">
                            <i class="fa fa-user-circle me-3"></i>
                            <span class="hide-menu" style="font-size: 16px;">Student</span>
                        </a>
                        <ul class="collapse first-level" aria-expanded="false">

                            <!-- My Grades -->
                            <li class="sidebar-item">
                                <a href="{{ url_for('dash.view_all_grades') }}" class="sidebar-link">
                                    <span class="hide-menu" style="font-size: 15px;">My Grades</span>
                                </a>
                            </li>

                            <!-- Grade Details (optional link placeholder) -->
                            <!-- Accessed via My Grades table -->

                            <!-- My Attendance -->
                            <li class="sidebar-item">
                                <a href="{{ url_for('dash.view_attendances') }}" class="sidebar-link">
                                    <span class="hide-menu" style="font-size: 15px;">My Attendance</span>
                                </a>
                            </li>

                            <!-- Attendance Details (optional link placeholder) -->
                            <!-- Accessed via My Attendance table -->

                            <!-- Class Assignments -->
                            <li class="sidebar-item">
                                <a href="{{ url_for('dash.view_class_assignments') }}" class="sidebar-link">
                                    <span class="hide-menu" style="font-size: 15px;">Class Assignments</span>
                                </a>
                            </li>

                            <!-- Assignment Submissions -->
                            <li class="sidebar-item">
                                <a href="{{ url_for('dash.view_assignment_submissions') }}" class="sidebar-link">
                                    <span class="hide-menu" style="font-size: 15px;">My Assignment Submissions</span>
                                </a>
                            </li>

                            <!-- Submission Detail (optional link placeholder) -->
                            <!-- Accessed via Assignment Submissions table -->

                        </ul>
                        </li>
                        {% endif %}

                        <!-- ===================== END ASSIGNMENT SUBMISSIONS MENU ===================== -->

                        <!-- ==================== STUDENT & ADMIN SIDEBAR ==================== -->
                       
                        <!-- ===================== STUDENT ONLY================= -->
                        <!-- Student/Admin Menu -->
                        {% if current_user.is_authenticated and current_user.role in ["student","admin"] %}
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link has-arrow" href="javascript:void(0)" aria-expanded="false">
                                <i class="fa fa-user-circle me-3"></i>
                                <span class="hide-menu">Student</span>
                            </a>
                            <ul class="collapse first-level" aria-expanded="false">

                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.view_assignment_submissions') }}" class="sidebar-link">
                                        <span class="hide-menu">View Submitted Assignments</span>
                                    </a>
                                </li>

                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.view_class_assignments') }}" class="sidebar-link">
                                        <span class="hide-menu">View Class Assignments</span>
                                    </a>
                                </li>

                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.view_all_grades') }}" class="sidebar-link">
                                        <span class="hide-menu">My Grades</span>
                                    </a>
                                </li>

                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.view_attendances') }}" class="sidebar-link">
                                        <span class="hide-menu">My Attendance</span>
                                    </a>
                                </li>

                            </ul>
                        </li>
                        {% endif %}

                        
                        
                        
                
                        {% if current_user.is_authenticated %}
                        <!-- Profile -->
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link" href="{{ url_for('dash.view_profile') }}" aria-expanded="false">
                                <i class="me-3 fa fa-user" aria-hidden="true"></i>
                                <span class="hide-menu">Profile</span>
                            </a>
                        </li>
                        {% endif %}
                        
                
                       
                        {% if current_user.is_authenticated %}
                            <!-- Logout -->
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link" id="logoutSidebar" aria-expanded="false">
                                <i class="me-3 fa fa-sign-out-alt" aria-hidden="true"></i>
                                <span class="hide-menu">Logout</span>
                            </a>
                        </li>
                        {% endif %}
                    </ul>
                </nav>
                <!-- End Sidebar navigation -->
            </div>
            <!-- End Sidebar scroll-->
        </aside>
        <!-- ============================================================== -->
        <!-- End Left Sidebar - style you can find in sidebar.scss  -->
        <!-- ============================================================== -->
        <!-- ============================================================== -->
        <!-- Page wrapper  -->
        <!-- ============================================================== -->
        <div class="page-wrapper">
            <!-- TOAST -->
            <div id="toast">
                <span id="toast-message"></span>
                <span class="close-toast" onclick="hideToast()">&times;</span>
            </div>
           
            {% block content %}
              
            {% endblock content %}
          


	          <footer class="footer text-center">
                ¬© {{ current_year }} Classroom Management Dashboard Created by <a href="https://www.naomiphiri.com/">Naomi Phiri</a> 
            </footer>
            <!-- ============================================================== -->
            <!-- End footer -->
            <!-- ============================================================== -->
        </div>
        <!-- ============================================================== -->
        <!-- End Page wrapper  -->
        <!-- ============================================================== -->
    </div>
    <!-- ============================================================== -->
    <!-- End Wrapper -->
    <!-- ============================================================== -->
    <!-- ============================================================== -->
<!-- 1Ô∏è‚É£ jQuery (FIRST, only once) -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- 2Ô∏è‚É£ Bootstrap 5 bundle (includes Popper) -->
<script src="{{ url_for('static', filename='assets/plugins/bootstrap/dist/js/bootstrap.bundle.min.js') }}"></script>

<!-- 3Ô∏è‚É£ Monster Admin core -->
<script src="{{ url_for('static', filename='js/app-style-switcher.js') }}"></script>
<script src="{{ url_for('static', filename='js/sidebarmenu.js') }}"></script>
<script src="{{ url_for('static', filename='js/custom.js') }}"></script>

<!-- 4Ô∏è‚É£ Charts -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{{ url_for('static', filename='js/custom_chart.js') }}"></script>

<!-- 5Ô∏è‚É£ Flot (AFTER jQuery) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.categories.min.js"></script>
<script src="{{ url_for('static', filename='js/custom_float.js') }}"></script>

<!-- 6Ô∏è‚É£ Dashboard page -->
<script src="{{ url_for('static', filename='js/pages/dashboards/dashboard1.js') }}"></script>

<!-- 7Ô∏è‚É£ Auth JS LAST -->
<script src="{{ url_for('auth.static', filename='js/auth.js') }}"></script>



 <!-- ---------- Chat widget HTML ---------- -->
 <button id="chatToggleBtn" class="chat-widget-btn" aria-label="Open chat" title="Chat with Omi">
  <!-- simple chat icon svg -->
  <svg class="chat-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
    <path d="M4 4h16v10H6l-2 2V4z" fill="#fff"></path>
  </svg>
</button>

<div id="chatPanel" class="chat-panel" role="dialog" aria-modal="false" aria-hidden="true">
  <div class="chat-header">
    <img src="{{ url_for('static', filename='assets/favicon/learning.png') }}" alt="bot" />
    <div style="flex:1;">
      <div class="title">Omi ‚Äî Classroom Bot</div>
      <div class="subtitle">Ask about attendance, assignments, or just say hi</div>
    </div>
    <div style="display:flex; gap:8px; align-items:center;">
      <button id="minimizeChat" class="btn btn-sm btn-light" title="Minimize">‚Äî</button>
      <button id="closeChat" class="btn btn-sm btn-outline-light text-dark" title="Close">‚úï</button>
    </div>
  </div>

  <div id="chatBody" class="chat-body" role="log" aria-live="polite">
    <!-- messages appended here -->
    <div class="chat-msg bot">Hello üëã ‚Äî I'm Omi. How can I help today?</div>
  </div>

  <div class="chat-input-row">
    <input id="chatInput" type="text" placeholder="Type your message..." aria-label="Message input" />
    <button id="chatSendBtn" title="Send">Send</button>
  </div>
</div>



<script>
    /* ---------- Navbar Dropdown Toggle (NO Bootstrap) ---------- */
(function () {

const toggle = document.querySelector('.user-dropdown-toggle');
const menu = document.querySelector('.navbar-nav .dropdown-menu');

if (!toggle || !menu) return;

toggle.addEventListener('click', function (e) {
    e.preventDefault();
    e.stopPropagation();
    menu.classList.toggle('show');
});

// Close when clicking outside
document.addEventListener('click', function () {
    menu.classList.remove('show');
});

})();
    // ---------- Chat widget behavior ----------
    (function () {
      const toggleBtn = document.getElementById('chatToggleBtn');
      const panel = document.getElementById('chatPanel');
      const chatBody = document.getElementById('chatBody');
      const chatInput = document.getElementById('chatInput');
      const sendBtn = document.getElementById('chatSendBtn');
      const closeBtn = document.getElementById('closeChat');
      const minimizeBtn = document.getElementById('minimizeChat');
  
      function openChat() {
        panel.classList.add('show');
        panel.setAttribute('aria-hidden', 'false');
        chatInput.focus();
      }
      function closeChat() {
        panel.classList.remove('show');
        panel.setAttribute('aria-hidden', 'true');
      }
      // toggle
      toggleBtn.addEventListener('click', function () {
        if (panel.classList.contains('show')) {
          closeChat();
        } else {
          openChat();
        }
      });
      // close & minimize
      closeBtn.addEventListener('click', closeChat);
      minimizeBtn.addEventListener('click', closeChat);
  
      // send message
      function appendMessage(text, who = 'bot') {
        const div = document.createElement('div');
        div.className = 'chat-msg ' + (who === 'user' ? 'user' : 'bot');
        div.textContent = text;
        chatBody.appendChild(div);
        chatBody.scrollTop = chatBody.scrollHeight;
      }
  
      async function sendMessage() {
        const text = chatInput.value.trim();
        if (!text) return;
        appendMessage(text, 'user');
        chatInput.value = '';
        chatInput.disabled = true;
        sendBtn.disabled = true;
  
        // Example: local placeholder response while you connect server
        appendMessage('Typing...', 'bot');
        // remove the 'Typing...' after delay and replace with response
        setTimeout(() => {
          // remove last bot 'Typing...' and add final
          const last = chatBody.querySelectorAll('.chat-msg.bot');
          const lastBot = last[last.length - 1];
          if (lastBot && lastBot.textContent === 'Typing...') {
            lastBot.textContent = "Thanks ‚Äî I received: " + text + ". (This is a demo reply.)";
          }
          chatInput.disabled = false;
          sendBtn.disabled = false;
          chatInput.focus();
          chatBody.scrollTop = chatBody.scrollHeight;
        }, 900);
  
        
        try {
          const resp = await fetch('/dash/chatbot', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ message: text })
          });
          const data = await resp.json();
          // replace the 'Typing...' placeholder with real reply
          const last = chatBody.querySelectorAll('.chat-msg.bot');
          const lastBot = last[last.length - 1];
          if (lastBot && lastBot.textContent === 'Typing...') lastBot.textContent = data.reply || 'No reply';
        } catch (err) {
          const last = chatBody.querySelectorAll('.chat-msg.bot');
          const lastBot = last[last.length - 1];
          if (lastBot && lastBot.textContent === 'Typing...') lastBot.textContent = 'Sorry ‚Äî failed to contact server.';
        } finally {
          chatInput.disabled = false;
          sendBtn.disabled = false;
          chatInput.focus();
        }
        
      }
  
      // Enter to send
      chatInput.addEventListener('keydown', function (e) {
        if (e.key === 'Enter') {
          e.preventDefault();
          sendMessage();
        }
      });
      sendBtn.addEventListener('click', sendMessage);
  
      // click outside panel to close (small screens)
      document.addEventListener('click', function (e) {
        if (window.innerWidth <= 480) {
          if (!panel.contains(e.target) && !toggleBtn.contains(e.target) && panel.classList.contains('show')) {
            closeChat();
          }
        }
      });
    })();
  
    
  </script>