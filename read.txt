Here is the cleanest and simplest way to configure Flask so you can save each file type to its own folder:

‚úÖ Folder Structure You Want
uploads/
    assignments_uploads/
    profile_photo/
    assignment_student_submission_files/

‚úÖ 1. Create the folders automatically

Put this after app = Flask(__name__):

import os

BASE_UPLOAD = os.path.join(os.getcwd(), "uploads")
ASSIGNMENT_UPLOAD = os.path.join(BASE_UPLOAD, "assignments_uploads")
PROFILE_PHOTO_UPLOAD = os.path.join(BASE_UPLOAD, "profile_photo")
STUDENT_SUBMISSION_UPLOAD = os.path.join(BASE_UPLOAD, "assignment_student_submission_files")

# Create folders if not exist
for folder in [BASE_UPLOAD, ASSIGNMENT_UPLOAD, PROFILE_PHOTO_UPLOAD, STUDENT_SUBMISSION_UPLOAD]:
    os.makedirs(folder, exist_ok=True)

‚úÖ 2. Add to Flask config
app.config["BASE_UPLOAD"] = BASE_UPLOAD
app.config["ASSIGNMENT_UPLOAD"] = ASSIGNMENT_UPLOAD
app.config["PROFILE_PHOTO_UPLOAD"] = PROFILE_PHOTO_UPLOAD
app.config["STUDENT_SUBMISSION_UPLOAD"] = STUDENT_SUBMISSION_UPLOAD

‚úÖ 3. Saving files (example routes)
üéì Save Assignment Files
@app.route('/upload/assignment', methods=['POST'])
def upload_assignment():
    file = request.files['file']
    filename = secure_filename(file.filename)
    file.save(os.path.join(app.config["ASSIGNMENT_UPLOAD"], filename))
    return "Assignment uploaded"

üßë‚Äçüè´ Save Profile Photo
@app.route('/upload/profile', methods=['POST'])
def upload_profile():
    file = request.files['file']
    filename = secure_filename(file.filename)
    file.save(os.path.join(app.config["PROFILE_PHOTO_UPLOAD"], filename))
    return "Profile photo uploaded"

üìù Save Student Assignment Submission
@app.route('/upload/submission', methods=['POST'])
def upload_submission():
    file = request.files['file']
    filename = secure_filename(file.filename)
    file.save(os.path.join(app.config["STUDENT_SUBMISSION_UPLOAD"], filename))
    return "Submission uploaded"

‚úÖ 4. How to store in DB

Example for your model:

new_file = AssignmentFileUpload(
    original_name=file.filename,
    filename=filename,
    filepath=os.path.join(app.config["ASSIGNMENT_UPLOAD"], filename)
)
db.session.add(new_file)
db.session.commit()

üí¨ If You Want I Can:

‚úî Create download route
‚úî Add file validation (PDF/images only)
‚úî Add unique filename generator
‚úî Integrate with your Assignment model

Just tell me ‚Äúshow full working code‚Äù ‚Äî and I‚Äôll write everything perfectly structured.



FILE LAYER

BACKEND
from flask import Flask, render_template, request, redirect, url_for, send_from_directory
from flask_sqlalchemy import SQLAlchemy
from werkzeug.utils import secure_filename
import os
from datetime import datetime

app = Flask(__name__)

# ---------------- CONFIG ----------------
app.config["SQLALCHEMY_DATABASE_URI"] = "sqlite:///files.db"
app.config["SQLALCHEMY_TRACK_MODIFICATIONS"] = False
app.config["UPLOAD_FOLDER"] = os.path.join(os.getcwd(), "static", "uploads")

db = SQLAlchemy(app)
os.makedirs(app.config["UPLOAD_FOLDER"], exist_ok=True)

# Allowed extensions
ALLOWED_EXTENSIONS = {
    "jpg", "jpeg", "png", "gif", "webp",
    "mp4", "webm", "ogg",
    "pdf",
    "doc", "docx", "txt"
}

def allowed_file(filename):
    return "." in filename and filename.rsplit(".", 1)[1].lower() in ALLOWED_EXTENSIONS


def get_file_type(filename):
    ext = filename.lower().split(".")[-1]

    if ext in ["jpg", "jpeg", "png", "gif", "webp"]:
        return "image"
    if ext in ["mp4", "webm", "ogg"]:
        return "video"
    if ext == "pdf":
        return "pdf"
    if ext in ["doc", "docx", "txt"]:
        return "document"
    return "other"


# ---------------- MODEL ----------------
class UploadedFile(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    filename = db.Column(db.String(255), nullable=False)
    filetype = db.Column(db.String(50), nullable=False)
    filepath = db.Column(db.String(255), nullable=False)
    uploaded_at = db.Column(db.DateTime, default=datetime.utcnow)


with app.app_context():
    db.create_all()


# ---------------- ROUTES ----------------

# READ + LIST
@app.route("/")
def index():
    files = UploadedFile.query.all()
    return render_template("index.html", files=files)


# CREATE
@app.route("/upload", methods=["POST"])
def upload_files():
    uploaded_files = request.files.getlist("files")

    if not uploaded_files:
        return "No files selected", 400

    for file in uploaded_files:
        if file and allowed_file(file.filename):

            filename = secure_filename(file.filename)
            filepath = os.path.join(app.config["UPLOAD_FOLDER"], filename)
            file.save(filepath)

            new_file = UploadedFile(
                filename=filename,
                filetype=get_file_type(filename),
                filepath=filepath
            )
            db.session.add(new_file)

    db.session.commit()
    return redirect(url_for("index"))


# SERVE FILES
@app.route("/uploads/<filename>")
def serve_file(filename):
    return send_from_directory(app.config["UPLOAD_FOLDER"], filename)


# UPDATE
@app.route("/update/<int:file_id>", methods=["POST"])
def update_file(file_id):
    file_obj = UploadedFile.query.get_or_404(file_id)
    new_file = request.files.get("file")

    if not new_file or not allowed_file(new_file.filename):
        return "Invalid file", 400

    # delete old file
    if os.path.exists(file_obj.filepath):
        os.remove(file_obj.filepath)

    filename = secure_filename(new_file.filename)
    filepath = os.path.join(app.config["UPLOAD_FOLDER"], filename)
    new_file.save(filepath)

    file_obj.filename = filename
    file_obj.filepath = filepath
    file_obj.filetype = get_file_type(filename)

    db.session.commit()
    return redirect(url_for("index"))


# DELETE
@app.route("/delete/<int:file_id>", methods=["POST"])
def delete_file(file_id):
    file_obj = UploadedFile.query.get_or_404(file_id)

    # delete physical file
    if os.path.exists(file_obj.filepath):
        os.remove(file_obj.filepath)

    db.session.delete(file_obj)
    db.session.commit()

    return redirect(url_for("index"))


if __name__ == "__main__":
    app.run(debug=True)



‚úÖ 1. ADD DOWNLOAD ROUTE (Flask)

Add this below your /uploads/<filename> route:

# DOWNLOAD
@app.route("/download/<filename>")
def download_file(filename):
    return send_from_directory(
        app.config["UPLOAD_FOLDER"],
        filename,
        as_attachment=True
    )

‚úÖ 2. UPDATED index.html ‚Äî Display Based on Filetype + Download

Replace your entire index.html with this improved version.

<!DOCTYPE html>
<html>
<head>
    <title>File Manager</title>
    <style>
        .file-box {
            border: 1px solid #ccc;
            padding: 10px;
            margin-bottom: 20px;
            width: 300px;
        }
        img {
            max-width: 100%;
            height: auto;
        }
        video {
            width: 100%;
            height: auto;
        }
        iframe {
            width: 100%;
            height: 300px;
        }
    </style>
</head>
<body>

<h2>Upload Files</h2>
<form action="{{ url_for('upload_files') }}" method="POST" enctype="multipart/form-data">
    <input type="file" name="files" multiple required>
    <button type="submit">Upload</button>
</form>

<hr>

<h2>Uploaded Files</h2>

{% for f in files %}
<div class="file-box">
    <h3>{{ f.filename }}</h3>
    <p>Type: {{ f.filetype }}</p>

    <!-- DISPLAY BASED ON FILETYPE -->
    {% if f.filetype == "image" %}
        <img src="{{ url_for('serve_file', filename=f.filename) }}" alt="Image">

    {% elif f.filetype == "video" %}
        <video controls>
            <source src="{{ url_for('serve_file', filename=f.filename) }}">
        </video>

    {% elif f.filetype == "pdf" %}
        <iframe src="{{ url_for('serve_file', filename=f.filename) }}"></iframe>

    {% elif f.filetype == "document" %}
        <p>Document file: {{ f.filename }}</p>

    {% else %}
        <p>Unknown file type</p>
    {% endif %}

    <br><br>

    <!-- DOWNLOAD BUTTON -->
    <a href="{{ url_for('download_file', filename=f.filename) }}">
        <button type="button">Download</button>
    </a>

    <!-- UPDATE FORM -->
    <form action="{{ url_for('update_file', file_id=f.id) }}" method="POST" enctype="multipart/form-data" style="margin-top:10px;">
        <input type="file" name="file" required>
        <button type="submit">Replace</button>
    </form>

    <!-- DELETE FORM -->
    <form action="{{ url_for('delete_file', file_id=f.id) }}" method="POST" style="margin-top:10px;">
        <button type="submit" style="color:red;">Delete</button>
    </form>
</div>
{% endfor %}

</body>
</html>

‚úÖ What this HTML does
If filetype = "image"

Shows an image preview.

If filetype = "video"

Shows a video player.

If filetype = "pdf"

Shows an embedded PDF viewer (iframe).

If filetype = "document" (doc, docx, txt)

Shows a simple text message.
(You cannot embed doc/docx ‚Äî browsers don‚Äôt support it.)

If filetype = "other"

Displays a fallback message.

Download Button

Uses:

<a href="{{ url_for('download_file', filename=f.filename) }}">


This triggers the Flask download route.

üéâ COMPLETE & PERFECT FILE CRUD SYSTEM

Now you have:

‚úî Upload (multiple files)
‚úî Display based on filetype
‚úî Replace file
‚úî Delete file
‚úî Download file
‚úî Secure filename
‚úî Files stored in DB



# ------------------ Admin Management End-Points ------------------------
# restrict access to endpoint based on role

    # classes = Class.query.all()
    # if request.method == "POST":
    #     name = request.form.get("name")
    #     class_id = request.form.get("class_id")
    #     if not name or not class_id:
    #         flash("All fields are required.", "danger")
    #         return redirect(url_for("dash.create_student"))

    #     student = Student(name=name, class_id=class_id)
    #     db.session.add(student)
    #     db.session.commit()
    #     flash("Student created successfully!", "success")
    #     return redirect(url_for("dash.create_student"))
    # return render_template("create_student.html", classes=classes)

    # ------------------ Student Management End-Points ------------------------
    # classes = Class.query.all()
    # if request.method == "POST":
    #     name = request.form.get("name")
    #     class_id = request.form.get("class_id")
    #     if not name or not class_id:
    #         flash("All fields are required.", "danger")
    #         return redirect(url_for("dash.create_student"))

    #     student = Student(name=name, class_id=class_id)
    #     db.session.add(student)
    #     db.session.commit()
    #     flash("Student created successfully!", "success")
    #     return redirect(url_for("dash.create_student"))
    # return render_template("create_student.html", classes=classes)


# ------------------ Assignments End-Points ------------------------ [Teacher & Admin]
      # students = Student.query.all()
    # if request.method == "POST":
    #     title = request.form.get("title")
    #     student_id = request.form.get("student_id")
    #     due_date = request.form.get("due_date")

    #     if not all([title, student_id, due_date]):
    #         flash("All fields are required.", "danger")
    #         return redirect(url_for("dash.create_assignment"))

    #     assignment = Assignment(title=title, student_id=student_id, due_date=due_date)
    #     db.session.add(assignment)
    #     db.session.commit()
    #     flash("Assignment created successfully!", "success")
    #     return redirect(url_for("dash.create_assignment"))

    # return render_template("create_assignment.html", students=students)



# ------------------ Assignment Submission End-Points ------------------------
      # students = Student.query.all()
    # if request.method == "POST":
    #     title = request.form.get("title")
    #     student_id = request.form.get("student_id")
    #     due_date = request.form.get("due_date")

    #     if not all([title, student_id, due_date]):
    #         flash("All fields are required.", "danger")
    #         return redirect(url_for("dash.create_assignment"))

    #     assignment = Assignment(title=title, student_id=student_id, due_date=due_date)
    #     db.session.add(assignment)
    #     db.session.commit()
    #     flash("Assignment created successfully!", "success")
    #     return redirect(url_for("dash.create_assignment"))

    # return render_template("create_assignment.html", students=students)

# ------------------ Attendance End-Points ------------------------
 # from .models import Student, Class, Attendance
    # from extensions import db

    # classes = Class.query.all()
    # students = Student.query.all()

    # if request.method == "POST":
    #     student_id = request.form.get("student_id")
    #     class_id = request.form.get("class_id")
    #     day = request.form.get("day")
    #     status = request.form.get("status")

    #     if not all([student_id, class_id, day, status]):
    #         flash("All fields are required.", "danger")
    #         return redirect(url_for("dash.create_attendance"))

    #     attendance = Attendance(
    #         student_id=student_id,
    #         class_id=class_id,
    #         day=day,
    #         status=status
    #     )
    #     db.session.add(attendance)
    #     db.session.commit()
    #     flash("Attendance created successfully!", "success")
    #     return redirect(url_for("dash.create_attendance"))

    # return render_template("create_attendance.html", classes=classes, students=students)

    # page = request.args.get('page', 1, type=int)
    # per_page = request.args.get('per_page', 10, type=int)
    
    # pagination = Attendance.query.order_by(Attendance.date.desc()).paginate(page=page, per_page=per_page)
    # attendances = pagination.items
    
    # return render_template("attendance/view_attendance.html", 
    #                        attendances=attendances, 
    #                        pagination=pagination)

# ------------------ Grade End-Points ------------------------
     # students = Student.query.all()
    # if request.method == "POST":
    #     student_id = request.form.get("student_id")
    #     subject = request.form.get("subject")
    #     score = request.form.get("score")

    #     if not all([student_id, subject, score]):
    #         flash("All fields are required.", "danger")
    #         return redirect(url_for("dash.create_grade"))

    #     grade = Grade(student_id=student_id, subject=subject, score=score)
    #     db.session.add(grade)
    #     db.session.commit()
    #     flash("Grade created successfully!", "success")
    #     return redirect(url_for("dash.create_grade"))

    # return render_template("create_grade.html", students=students)



      {% if  current_user.is_authenticated and current_user.role == "student" %}
                            <!-- Students Only -->
                        <li class="sidebar-item">
                            <a class="sidebar-link waves-effect waves-dark sidebar-link has-arrow" href="javascript:void(0)" aria-expanded="false">
                                <i class="fa fa-user-circle me-3"></i>
                                <span class="hide-menu">Student</span>
                            </a>
                            <ul class="collapse first-level" aria-expanded="false">
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.view_student_grades') }}" class="sidebar-link"><span class="hide-menu">View grades</span></a>
                                </li>
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.view_student_assignments') }}" class="sidebar-link"><span class="hide-menu">View  Assignments</span></a>
                                </li>
                                <li class="sidebar-item">
                                    <a href="{{ url_for('dash.view_student_attendances') }}" class="sidebar-link"><span class="hide-menu">View Attendances</span></a>
                                </li>
                            </ul>
                        </li>
                        {% endif %}